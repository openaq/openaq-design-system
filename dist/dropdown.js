"use strict";var _react=_interopRequireDefault(require("react")),_propTypes=require("prop-types"),_reactTether=_interopRequireDefault(require("react-tether")),_reactAddonsCssTransitionGroup=_interopRequireDefault(require("react-addons-css-transition-group")),_createReactClass=_interopRequireDefault(require("create-react-class"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,o=arguments[t];for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},_extends.apply(this,arguments)}var Dropdown=(0,_createReactClass.default)({displayName:"Dropdown",propTypes:{triggerElement:_propTypes.PropTypes.oneOf(["a","button"]),triggerClassName:_propTypes.PropTypes.string,triggerActiveClassName:_propTypes.PropTypes.string,triggerTitle:_propTypes.PropTypes.string,triggerText:_propTypes.PropTypes.string.isRequired,direction:_propTypes.PropTypes.oneOf(["up","down"]),alignment:_propTypes.PropTypes.oneOf(["left","center","right"]),className:_propTypes.PropTypes.string,children:_propTypes.PropTypes.node},_bodyListener:function(e){var t=e.target;if("BODY"!==t.tagName&&"HTML"!==t.tagName&&"dropdown:close"!==e.target.getAttribute("data-hook")){if("SPAN"!==t.tagName||t.parentNode!==this.refs.trigger||"dropdown:btn"!==t.parentNode.getAttribute("data-hook"))if(t&&"dropdown:btn"===t.getAttribute("data-hook"))t!==this.refs.trigger&&this.close();else{for(;(!t||"dropdown:content"!==t.getAttribute("data-hook"))&&(t=t.parentNode,t&&"BODY"!==t.tagName&&"HTML"!==t.tagName););t!==this.refs.dropdown&&this.close()}}else this.close()},getDefaultProps:function(){return{triggerElement:"button",direction:"down",alignment:"center"}},getInitialState:function(){return{open:!1}},componentDidMount:function(){window.addEventListener("click",this._bodyListener)},componentWillUnmount:function(){window.removeEventListener("click",this._bodyListener)},_toggleDropdown:function(e){e.preventDefault(),this.toggle()},toggle:function(){this.setState({open:!this.state.open})},open:function(){this.setState({open:!0})},close:function(){this.setState({open:!1})},render:function(){var e=["drop__content","drop__content--react"],t=["drop__toggle"];this.props.className&&e.push(this.props.className),this.props.triggerClassName&&t.push(this.props.triggerClassName);var r={};"button"===this.props.triggerElement?r.type="button":r.href="#",this.props.triggerTitle&&(r.title=this.props.triggerTitle);var o="down"===this.props.direction?"top":"bottom",n="down"===this.props.direction?"bottom":"top";return o+=" "+this.props.alignment,n+=" "+this.props.alignment,this.state.open&&this.props.triggerActiveClassName&&t.push(this.props.triggerActiveClassName),_react.default.createElement(_reactTether.default,{attachment:o,targetAttachment:n,constraints:[{to:"scrollParent",attachment:"together"}]},_react.default.createElement(this.props.triggerElement,_extends({},r,{className:t.join(" "),onClick:this._toggleDropdown,"data-hook":"dropdown:btn",ref:"trigger"}),_react.default.createElement("span",null,this.props.triggerText)),_react.default.createElement(_reactAddonsCssTransitionGroup.default,{component:"div",transitionName:"drop-trans",transitionEnterTimeout:300,transitionLeaveTimeout:300},this.state.open?_react.default.createElement("div",{className:e.join(" "),ref:"dropdown","data-hook":"dropdown:content"},this.props.children):null))}});module.exports=Dropdown;