"use strict";var _react=_interopRequireDefault(require("react")),_reactTether=_interopRequireDefault(require("react-tether")),_reactAddonsCssTransitionGroup=_interopRequireDefault(require("react-addons-css-transition-group"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _extends(){return _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},_extends.apply(this,arguments)}var Dropdown=_react.default.createClass({displayName:"Dropdown",propTypes:{triggerElement:_react.default.PropTypes.oneOf(["a","button"]),triggerClassName:_react.default.PropTypes.string,triggerActiveClassName:_react.default.PropTypes.string,triggerTitle:_react.default.PropTypes.string,triggerText:_react.default.PropTypes.string.isRequired,direction:_react.default.PropTypes.oneOf(["up","down"]),alignment:_react.default.PropTypes.oneOf(["left","center","right"]),className:_react.default.PropTypes.string,children:_react.default.PropTypes.node},_bodyListener:function(t){var e=t.target;if("BODY"!==e.tagName&&"HTML"!==e.tagName&&"dropdown:close"!==t.target.getAttribute("data-hook")){if("SPAN"!==e.tagName||e.parentNode!==this.refs.trigger||"dropdown:btn"!==e.parentNode.getAttribute("data-hook"))if(e&&"dropdown:btn"===e.getAttribute("data-hook"))e!==this.refs.trigger&&this.close();else{do{if(e&&"dropdown:content"===e.getAttribute("data-hook"))break;e=e.parentNode}while(e&&"BODY"!==e.tagName&&"HTML"!==e.tagName);e!==this.refs.dropdown&&this.close()}}else this.close()},getDefaultProps:function(){return{triggerElement:"button",direction:"down",alignment:"center"}},getInitialState:function(){return{open:!1}},componentDidMount:function(){window.addEventListener("click",this._bodyListener)},componentWillUnmount:function(){window.removeEventListener("click",this._bodyListener)},_toggleDropdown:function(t){t.preventDefault(),this.toggle()},toggle:function(){this.setState({open:!this.state.open})},open:function(){this.setState({open:!0})},close:function(){this.setState({open:!1})},render:function(){var t=["drop__content","drop__content--react"],e=["drop__toggle"];this.props.className&&t.push(this.props.className),this.props.triggerClassName&&e.push(this.props.triggerClassName);var r={};"button"===this.props.triggerElement?r.type="button":r.href="#",this.props.triggerTitle&&(r.title=this.props.triggerTitle);var o="down"===this.props.direction?"top":"bottom",n="down"===this.props.direction?"bottom":"top";return o+=" "+this.props.alignment,n+=" "+this.props.alignment,this.state.open&&this.props.triggerActiveClassName&&e.push(this.props.triggerActiveClassName),_react.default.createElement(_reactTether.default,{attachment:o,targetAttachment:n,constraints:[{to:"scrollParent",attachment:"together"}]},_react.default.createElement(this.props.triggerElement,_extends({},r,{className:e.join(" "),onClick:this._toggleDropdown,"data-hook":"dropdown:btn",ref:"trigger"}),_react.default.createElement("span",null,this.props.triggerText)),_react.default.createElement(_reactAddonsCssTransitionGroup.default,{component:"div",transitionName:"drop-trans",transitionEnterTimeout:300,transitionLeaveTimeout:300},this.state.open?_react.default.createElement("div",{className:t.join(" "),ref:"dropdown","data-hook":"dropdown:content"},this.props.children):null))}});module.exports=Dropdown;